% This presentation is based on a Beamer theme from Seth Brown, distributed
% under the following license:
%
% ----------------------------------------------------------------------------
% This program can be redistributed and/or modified under the terms
% of the GNU Public License, version 3.
%
% Seth Brown, Ph.D.
% sethbrown@drbunsen.org

\documentclass[t]{beamer}

\usepackage{hyperref} % urls
\usepackage{graphicx} % graphics
\usepackage[utf8x]{inputenc}
\usepackage{fancyvrb}
\usepackage{tcolorbox}
\usepackage{textcomp}
\usepackage{tikz}
\usetikzlibrary{positioning, decorations.pathreplacing, shapes, arrows}
\usepackage{sidecap}

% suppress navigation bar
\beamertemplatenavigationsymbolsempty

\mode<presentation>
{
  \usetheme{codeplay}
  \setbeamercovered{transparent}
  \setbeamertemplate{itemize item}[circle]
  \setbeamertemplate{itemize subitem}{\tiny\raise1.5pt\hbox{\donotcoloroutermaths$\blacktriangleright$}}
  \setbeamertemplate{section in toc shaded}[default][100]
  \setbeamertemplate{subsection in toc shaded}[default][100]

\setbeamertemplate{subsection in toc}{%
\leavevmode\leftskip=4.00ex%
  \llap{\raisebox{0.15ex}{\textcolor{structure}{\small$\bullet$}}\kern1ex}%
  \inserttocsubsection\par%
}
}

% set fonts
\usepackage{fontspec}
% These fonts don't work on Linux - proprietary MS
%\setsansfont{Calibri}
%\setmonofont{Consolas}
\setsansfont{Carlito}
\setmonofont{Inconsolata}
\setbeamerfont{frametitle}{size=\LARGE,series=\bfseries}

% color definitions
\usepackage{color}
\definecolor{uiwhite}{RGB}{255, 255, 255}
\definecolor{uidarkgray}{RGB}{24,24,25}
\definecolor{uigray}{RGB}{51,51,51}
\definecolor{uilightgray}{RGB}{123,123,123}
\definecolor{uilightlightgray}{RGB}{241,241,241}
\definecolor{uicyan}{RGB}{0,255,255}
\definecolor{uipurple}{RGB}{180,14,184}
\definecolor{uiblue}{RGB}{0,0,255}
\definecolor{uiorange}{RGB}{255,160,0}
\hypersetup{colorlinks,urlcolor=uiblue,linkcolor=white}

% title slide definition
\title{LLDB Tutorial: Adding debugger support for your target}
\subtitle{LLVM 2016 tutorial}
\author{Deepak Panickal \\ Andrzej Warzy\'nski}
\institute{Codeplay Software \\ @codeplaysoft}

\date{March 18, 2016}

% Code box formatting
% Commenting out this - otherwise we can't change the font size in code boxes
% \fvset{fontsize=\scriptsize,tabsize=4}
\tcbset{colback=uilightlightgray,colframe=uilightgray,colupper=uidarkgray,
        left=1pt,right=1pt,top=1pt,bottom=1pt,arc=0pt,
        toprule=1pt,bottomrule=1pt,leftrule=1pt,rightrule=1pt}

\newenvironment{codebox}
 {\VerbatimEnvironment
  \begin{tcolorbox}%
  \begin{Verbatim}[fontsize=\scriptsize,tabsize=4]}
 {\end{Verbatim}\end{tcolorbox}}

 \newenvironment{codebox2}
 {\VerbatimEnvironment
  \begin{tcolorbox}%
  \begin{Verbatim}[commandchars=\\\{\},fontsize=\tiny,tabsize=4]}
  {\end{Verbatim}\end{tcolorbox}}

% Code caption that comes after the code box.
\newcommand{\codecaption}[2][-4.4ex]{%
  \vspace{#1}
  \hfill\mbox{\footnotesize{\textcolor{uiblue}{#2}}\hspace{0.5em}}
  \vspace*{2ex}}

\newcommand{\sourcebox}[3][firstline=1]{%
  \begin{tcolorbox}\VerbatimInput[#1]{#2}\end{tcolorbox}
  \codecaption{#3}}

\newcommand{\examplebox}[2][firstline=1]{\sourcebox[#1]{examples/#2}{#2}}

\newcommand{\codeempha}[1]{\textcolor{uiorange}{#1}}
\newcommand{\codeemphb}[1]{\textcolor{uipurple}{#1}}
\newcommand{\codeemphc}[1]{\textcolor{uiblue}{#1}}


% FIXME: vfill doesn't work here!
\newcommand{\pipelinemap}[2]{\vspace{#2} #1}

% Create a slide for a part.
\newcommand{\talkpart}[2]{%
\section{Part #1: #2}

\begin{frame}[c]{Part #1}

\vspace{1cm}
\centerline{\LARGE{#2}}

\end{frame}}

% Create a slide for a part section.
\newcommand{\talksection}[1]{%
\subsection{#1}
\begin{frame}{\insertsectionhead}
\vspace{2ex}
\begin{NoHyper}
\tableofcontents[sectionstyle=hide,subsectionstyle=show/shaded/hide]
\end{NoHyper}
\end{frame}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\setbeamertemplate{background}
{\includegraphics[width=\paperwidth,height=\paperheight]{dark_background_title.png}}
\setbeamertemplate{footline}[default]

\begin{frame}
  \vspace{4ex}
  \titlepage
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Set the background for the rest of the slides.
%\setbeamertemplate{background}
% {\includegraphics[width=\paperwidth,height=\paperheight]{dark_background.png}}
\setbeamertemplate{background}{}
\setbeamertemplate{footline}[codeplaytheme]

\section*{Outline}

\begin{frame}{Outline}
\begin{itemize}
    \setlength\itemsep{1em}
    \item LLDB architecture crash course
    \begin{itemize}
        \setlength\itemsep{1em}
        \item Overview of LLDB
        \item User scenarios such as breakpoints, stack-walking etc.
        \item Debugging tips
    \end{itemize}
    \item Both generic and specialized architectures are covered
    \begin{itemize}
        \setlength\itemsep{1em}
        \item \codeempha{MSP430} lldb debugging, which we have implemented for this tutorial
        \begin{itemize}
            \item \href{http://github.com/codeplaysoftware/lldb-msp430}{\nolinkurl{github.com/codeplaysoftware/lldb-msp430}}
       \end{itemize}
        \item \codeempha{ARM} architecture is also referred to for the generic cases
    \end{itemize}
    \item Focusing on debugging \codeempha{ELF} executables on \codeempha{Linux}
\end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Overview}
\hypersetup{linkcolor=black}
\tableofcontents
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\include{Slides}

%\talkpart{2}{Creating your own target}
%\include{SlidesBeamer-part2}

%\talkpart{3}{How-tos for specific tasks}
%\include{SlidesBeamer-part3}

%\talkpart{4}{Troubleshooting and resources}
%\include{SlidesBeamer-part4}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Conclusion}

\begin{frame}{Homework}
\begin{itemize}
    \setlength\itemsep{1em}
    \item Test with actual \codeempha{hardware}
    \item Investigating the ABI and disassembly
    \item \codeempha{Upstreaming}
    \item Similar thing can be done for \codeempha{AVR}
    \begin{itemize}
        \setlength\itemsep{1em}
        \item Yet another simple RISC architecture, used in Arduino
        \item \href{http://avr-eclipse.sourceforge.net/wiki/index.php/Debugging}{\nolinkurl{avr-eclipse.sourceforge.net/wiki/index.php/Debugging}}
    \end{itemize}
    \item Check out our code from GitHub:
    \begin{itemize}
        \item \href{http://github.com/codeplaysoftware/lldb-msp430}{\nolinkurl{github.com/codeplaysoftware/lldb-msp430}}
    \end{itemize}
\end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Final hint}
\vspace{20pt}
\Large
Wondering how to write a debugger for your architecture? 
\vspace{1mm}
\quad \\ 
Get in touch with Codeplay!
    \begin{itemize}
        \setbeamertemplate{itemize item}{$\Rightarrow$}
        \setlength\itemsep{0.75em}
        \item \href{mailto:deepak@codeplay.com}{\nolinkurl{deepak@codeplay.com}}
        \item \href{mailto:andrzej@codeplay.com}{\nolinkurl{andrzej@codeplay.com}}
        \item \href{http://www.codeplay.com}{\nolinkurl{www.codeplay.com}}
    \end{itemize}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}
